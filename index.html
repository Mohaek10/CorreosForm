<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="validaciones.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>Formulario de Envío</title>
    <script type="text/javascript">
        function validarFormulario() {
            let res = true;
            var mensaje = "";
            if (!validString(nombre.value, 2, 50) && nombre.disabled === false) {
                res = false;
                mensaje += "El nombre debe de tener un mínimo de 2 caracteres y un máximo de 50\n";
            }
            if (!validString(empresa.value, 3, 50) && empresa.disabled === false) {
                res = false;
                mensaje += "La empresa debe de tener un mínimo de 3 caracteres y un máximo de 50\n";
            }
            if (!validSelect(tipoDocumento)) {
                res = false;
                mensaje += "Debe de seleccionar un tipo de documento\n";
            }
            if (validarDocumento(numeroDocumento, tipoDocumento, numeroDocumento.parentNode) === false) {
                res = false;
                mensaje += "Ha habido un error en el documento" + "\n"
            }
            if (!validString(tipoVia.value, 2, 10)) {
                res = false;
                mensaje += "El tipo de vía debe de tener un mínimo de 2 caracteres y un máximo de 10\n";
            }
            if (!validString(nombreVia.value, 2, 50)) {
                res = false;
                mensaje += "El nombre de la vía debe de tener un mínimo de 2 caracteres y un máximo de 50\n";
            }
            if (!validNumber(numeroVia, 1, 100)) {
                res = false;
                mensaje += "El número de la vía debe de tener un mínimo de 1 y un máximo de 100\n";
            }
            if (!validCodPostal(codigoPostal)) {
                res = false;
                mensaje += "El código postal debe de tener 5 dígitos mayor que 1000 y menor que 52999\n";
            }
            if (!validarTelefono(movil.value)) {
                res = false;
                mensaje += "El número de movil sms debe de tener 9 dígitos y empezar por 6,7,8 o 9\n";
            }
            if (!validarTelefono(telefono.value)) {
                res = false;
                mensaje += "El número de teléfono debe de tener 9 dígitos y empezar por 6,7,8 o 9\n";
            }
            if (!validEmail(email)) {
                res = false;
                mensaje += "El email no es válido\n";
            }
            if (!validNumber(peso, 0, 10000)) {
                res = false;
                mensaje += "El peso debe de ser mayor que 0 y menor que 10000\n";
            }
            if (!validFecha(fecha, new Date()) && fecha.disabled === false) {
                res = false;
                mensaje += "La fecha debe de ser mayor que la fecha de hoy\n";
            }
            if (!validNumber(importeSeguro, 0, 10000) && importeSeguro.disabled === false) {
                res = false;
                mensaje += "El importe del seguro debe de ser mayor que 0 y menor que 10000\n";
            }
            if (!validNumber(importeReembolso, 0, 10000) && importeReembolso.disabled === false) {
                res = false;
                mensaje += "El importe del reembolso debe de ser mayor que 0 y menor que 10000\n";
            }
            if (!validFecha(fechaRecogida, new Date()) && fechaRecogida.disabled === false) {
                res = false;
                mensaje += "La fecha de recogida debe de ser mayor que la fecha de hoy\n";
            }
            if (!validarTamanoTextArea(observaciones, 150)) {
                res = false;
                mensaje += "El texto no puede superar los 150 caracteres\n";
            }


            if (res === false)
                alert(mensaje);

            console.log(mensaje);
            return res;

        }

        function recuperarDatos(){
            let datos = "";
            datos += "Nombre: " + nombre.value + "\n";
            datos += "Empresa: " + empresa.value + "\n";
            datos += "Tipo de documento: " + tipoDocumento.value + "\n";
            datos += "Número de documento: " + numeroDocumento.value + "\n";
            datos += "Tipo de vía: " + tipoVia.value + "\n";
            datos += "Nombre de la vía: " + nombreVia.value + "\n";
            datos += "Número de la vía: " + numeroVia.value + "\n";
            datos += "Piso: " + piso.value + "\n";
            datos += "Puerta: " + puerta.value + "\n";
            datos += "Escalera: " + escalera.value + "\n";
            datos += "Código postal: " + codigoPostal.value + "\n";
            datos += "Provincia: " + provincia.value + "\n";
            datos += "Móvil: " + movil.value + "\n";
            datos += "Teléfono: " + telefono.value + "\n";
            datos += "Email: " + email.value + "\n";
            datos += "Peso: " + peso.value + "\n";
            datos += "Peso volumétrico: " + pVolumetrico.value + "\n";
            datos += "Alto: " + alto.value + "\n";
            datos += "Ancho: " + ancho.value + "\n";
            datos += "Largo: " + largo.value + "\n";
            datos += "Fecha de vuelta: " + fecha.value + "\n";
            datos += "Importe del seguro: " + importeSeguro.value + "\n";
            datos += "Importe del reembolso: " + importeReembolso.value + "\n";
            datos += "IBAN: " + numeroIban.value + "\n";
            datos += "Fecha de recogida: " + fechaRecogida.value + "\n";
            datos += "Observaciones: " + observaciones.value + "\n";

            return datos;
        }

    </script>
</head>

<body>
<header class="bg-dark text-white text-center p-2">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <img src="img/portada_correos_2.jpg" alt="foto" width="150">
            </div>
            <div class="mt-4">
                <h1>CORREOS LEGANÉS</h1>
            </div>
        </div>
    </div>
</header>

<form id="formularioEnvio" action="javascript:alert(recuperarDatos())" class="needs-validation" onsubmit="return validarFormulario()">
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-6">
                <!-- Nombre o Empresa -->
                <div class="form-group">
                    <label for="nombre">Nombre</label>
                    <input type="text" name="nombre" id="nombre" class="form-control"
                           placeholder="Debe introducir el nombre o la empresa"
                           onblur="validarStringInside(this, 2, 50, this.parentNode)"
                           oninput="validarInput(this, 'empresa')">
                    <div class="invalid-feedback">Mínimo tiene que haber 2 caracteres y máximo 50</div>

                    <div class="form-group">
                        <label for="empresa">Empresa</label>
                        <input type="text" name="empresa" id="empresa" class="form-control"
                               placeholder="Debe introducir el nombre o la empresa"
                               onblur="validarStringInside(this, 3, 50, this.parentNode)"
                               oninput="validarInput(this, 'nombre')">
                        <div class="invalid-feedback">Mínimo tiene que tener 3 caracteres y máximo 50</div>
                    </div>
                </div>

                <!--Documento de identidad -->
                <div class="form-group row">
                    <div class="col-md-6">
                        <label for="tipoDocumento">Tipo de Documento:</label>
                        <select class="form-control  " id="tipoDocumento" name="tipoDocumento"
                                onblur="validarSelectInside(this,this.parentNode)">
                            <option value="">Seleccionar</option>
                            <option value="NIF">NIF</option>
                            <option value="NIE">NIE</option>
                            <option value="CIF">CIF</option>
                        </select>
                        <div class="invalid-feedback">Es necesario seleccionar el tipo de documento</div>
                    </div>
                    <div class="col-md-6">
                        <label for="numeroDocumento">Número de Documento:</label>
                        <input type="text" class="form-control" id="numeroDocumento" name="numeroDocumento"
                               onblur="validarDocumento(this,tipoDocumento,this.parentNode)"
                               placeholder="Numero de documento">
                        <div class="invalid-feedback">NIF, NIE o CIF invalido revise sus datos</div>
                    </div>
                </div>

                <!-- Tipo de vía -->
                <div class="form-group row">
                    <div class="col-md-4">
                        <label for="tipoVia">Tipo de Vía:</label>
                        <input type="text" class="form-control " id="tipoVia" name="tipoVia"
                               placeholder="Calle, Plaza..." onblur="validarStringInside(this,2,10,this.parentNode)">
                        <div class="invalid-feedback"> La vía debe de tener un min de 2 un máximo de 10 carácteres
                        </div>
                    </div>
                    <div class="col-md-8">
                        <label for="nombreVia">Nombre de la Vía:</label>
                        <input type="text" class="form-control" id="nombreVia" name="nombreVia"
                               placeholder="Nombre de vía" onblur="validarStringInside(this,2,50,this.parentNode)">
                        <div class="invalid-feedback" id="errorVia"> La vía debe de tener un min de 2 un máximo de
                            50
                            carácteres
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <!-- Número, Piso, Puerta y Escalera -->
                <div class="row d-flex">
                    <div class="col-md-3">
                        <label for="numeroVia">Número:</label>
                        <input type="number" class="form-control" id="numeroVia" name="numeroVia"
                               onblur="validarNumeroDeVia(this,this.parentNode)" placeholder="Número">
                        <div class="invalid-feedback">Datos incorrectos</div>
                    </div>
                    <div class="col-md-3">
                        <label for="piso">Piso:</label>
                        <input type="number" class="form-control" id="piso" name="piso" placeholder="Piso"
                               onblur="validarNumeroDeVia(this,this.parentNode)">
                        <div class="invalid-feedback">Datos incorrectos</div>
                    </div>
                    <div class="col-md-3">
                        <label for="puerta">Puerta:</label>
                        <input type="text" class="form-control" id="puerta" name="puerta" placeholder="Puerta">
                        <div class="invalid-feedback"></div>
                    </div>
                    <div class="col-md-3">
                        <label for="escalera">Escalera:</label>
                        <input type="text" class="form-control" id="escalera" name="escalera"
                               placeholder="Escalera">
                        <div class="invalid-feedback"></div>
                    </div>
                </div>

                <div class="row">
                    <!-- Código Postal y Provincia -->
                    <div class="form-group col-md-6">
                        <label for="codigoPostal">Código Postal:</label>
                        <input type="text" class="form-control" id="codigoPostal" name="codigoPostal"
                               oninput="actualizarProvinciaEnInput()"
                               onblur="validarCodigoPostalInside(this,this.parentNode)"
                               placeholder="28000">

                        <div class=" invalid-feedback">Codigo postal incorrecto, debe de tener 5 dígitos mayor que
                            1000
                            y
                            menor que 52999
                        </div>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="provincia">Provincia:</label>
                        <input type="text" class="form-control" id="provincia" name="provincia" disabled>
                        <div class="invalid-feedback"></div>
                    </div>
                </div>

                <!-- Contacto -->
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="movil">Móvil:</label>
                        <input type="tel" class="form-control" id="movil" name="movil"
                               onblur="validarNumeroTelefono(this,this.parentNode)"
                               placeholder="600000000">
                        <div class="invalid-feedback">
                            El número de teléfono debe de tener 9 dígitos y empezar por 6,7,8 o 9
                        </div>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="telefono">Teléfono:</label>
                        <input type="tel" class="form-control" id="telefono" name="telefono"
                               onblur="validarNumeroTelefono(this,this.parentNode)"
                               placeholder="60000000">
                        <div class="invalid-feedback">
                            El número de teléfono debe de tener 9 dígitos y empezar por 6,7,8 o 9
                        </div>
                    </div>
                </div>

                <!-- Email -->
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" class="form-control" id="email" name="email"
                           onblur="validarEmailInside(this,this.parentNode)"
                           placeholder="email@ejemplo.com">
                    <div class="invalid-feedback">Correo inválido, por favor ingrese un correo válido</div>
                </div>

            </div>
        </div>
        <hr class="my-3 bg-warning">
        <div class="row">

            <div class="col-md-6">
                <h4 class="">Peso y Tamaño del paquete</h4>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="peso">Peso en kg:</label>
                        <div class="input-group">
                            <input type="number" class="form-control w-75" id="peso" name="peso"
                                   onblur="validarNumeroInside(this,0,10000,this.parentNode)">
                            <div class="invalid-feedback">Peso invalido, más 10000 Kg y minimo 0 kg</div>
                            <div class="input-group-text">KG</div>

                        </div>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="pVolumetrico">Peso volumétrico</label>
                        <input type="number" class="form-control" id="pVolumetrico" name="pVolumetrico" disabled>
                    </div>
                </div>
                <div class="d-inline-flex mt-1 form-group">
                    <div class="d-flex small m-1">
                        <label for="alto">Altura (cm)</label>
                        <input type="text" name="alto" id="alto" class="form-control">
                    </div>
                    <div class="d-flex small m-1">
                        <label for="ancho">Ancho (cm)</label>
                        <input type="text" name="ancho" id="ancho" class="form-control">
                    </div>
                    <div class="d-flex small m-1">
                        <label for="largo">Largo (cm)</label>
                        <input type="text" name="largo" id="largo" class="form-control">
                    </div>
                    <div class="ml-5">
                        <button type="button" class="btn btn-secondary"
                                onclick="pesoVolumetrico(alto,ancho,largo,pVolumetrico)"> Calcular
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <h4>Servicios extra</h4>

                <p>Indica si desea preparar un envío de vuelta asociado</p>
                <div class="form-check">
                    <input type="checkbox" name="envioDeVuelta" id="envioDeVuelta"
                           class="form-check-inline d-inline-block" onclick="unlock(this,fecha)">
                    <label for="envioDeVuelta" class="w-50">Preparar envío de vuelta asociado</label>
                </div>
                <div class="form-group">
                    <div>
                        <label for="fecha">Fecha envío de Vuelta</label>
                        <input type="text" name="fecha" id="fecha" class="form-control w-50"
                               placeholder="20/11/2023" disabled onblur="validarFechaInside(this,this.parentNode)">
                        <div class="invalid-feedback">La fecha debe ser mayor a la fecha de hoy</div>
                    </div>
                </div>
            </div>

        </div>
        <hr class="my-3 bg-warning">
        <div class="row">
            <div class="col-md-4 card">
                <h4>Seguro a todo riesgo</h4>
                <div class="form-check">
                    <input type="checkbox" name="seguro" id="seguro" class="form-check-inline"
                           onclick="unlock(this,importeSeguro)">
                    <label for="seguro">Contratar seguro a todo riesgo</label>
                </div>
                <div class="form-group">
                    <div>
                        <label for="importeSeguro">Importe del seguro</label>
                        <input type="text" name="importeSeguro" id="importeSeguro" class="form-control "
                               placeholder="20€" disabled onblur="validarNumeroInside(this,0,10000,this.parentNode)">
                        <div class="invalid-feedback">El importe debe ser mayor que 0 y menor que 10000</div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 card">
                <h4>Servicio de reembolso a cuenta</h4>
                <div class="form-group">
                    <input type="checkbox" name="reembolso" id="reembolso"
                           onclick="unlock(this,importeReembolso); unlock(this,numeroIban)">
                    <label for="reembolso">Solicitar reembolso a cuenta</label>
                </div>
                <div class="form-group">
                    <div>
                        <label for="importeReembolso">Importe del reembolso</label>
                        <input type="text" name="importeReembolso" id="importeReembolso" class="form-control"
                               placeholder="20€" disabled
                               onblur="validarNumeroInside(this,0,10000,this.parentNode)">
                        <div class="invalid-feedback">El importe debe ser mayor que 0 y menor que 10000</div>
                    </div>
                    <label for="numeroIban">IBAN</label>
                    <input type="text" name="numeroIban" id="numeroIban" class="form-control" disabled
                           placeholder="ES00 0000 0000 0000 0000 0000"
                           onblur="validarIbanInside(this,this.parentNode)">
                    <div class="invalid-feedback">El IBAN no es válido</div>
                </div>
            </div>
            <div class="col-md-4 card">
                <h4>Recogida</h4>
                <div class="form-check">
                    <input type="checkbox" name="recogida" id="recogida" class="form-check-inline"
                           onclick="unlock(this,fechaRecogida)">
                    <label for="recogida">Solicitar recogida</label>
                </div>
                <div class="form-group">
                    <div>
                        <label for="fechaRecogida">Fecha de recogida</label>
                        <input type="text" name="fechaRecogida" id="fechaRecogida" class="form-control w-50"
                               placeholder="20/11/2023" disabled
                               onblur="validarFechaInside(this,this.parentNode)"
                        >
                        <div class="invalid-feedback">La fecha debe ser mayor a la fecha de hoy</div>
                    </div>
                </div>
            </div>
        </div>

        <hr class="my-3 bg-warning">

        <div class="form-group">
            <label for="observaciones">Observaciones</label>
            <textarea name="observaciones" id="observaciones" cols="30" rows="10" class="form-control"
                      placeholder="Observaciones"
                      onblur="comprobarMaxTextArea(this,150,this.parentNode)"></textarea>
            <div class="invalid-feedback">El texto no puede superar los 150 caracteres</div>
        </div>


        <button type="submit" class="btn btn-primary"><i class="fa fa-paper-plane"></i> Enviar</button>
    </div>

</form>


</body>

</html>